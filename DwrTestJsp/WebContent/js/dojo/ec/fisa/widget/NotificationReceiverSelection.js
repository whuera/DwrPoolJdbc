//>>built
require({cache:{"url:ec/fisa/widget/templates/NotificationReceiverSelection.html":'\x3cdiv data-dojo-attach-point\x3d"multilingual_container_node"\n\tclass\x3d"${styleClass}"\x3e\n\n\t\x3ctable\x3e\n\t\t\x3ctr\x3e\n\t\t\t\x3ctd style\x3d"border: thin solid"\x3e\n\t\t\t\t\x3cdiv style\x3d"float: left; width: auto" data-dojo-attach-point\x3d"_tcn"\x3e\x3c/div\x3e\n\t\t\t\x3c/td\x3e\n\t\t\x3c/tr\x3e\n\t\t\x3ctr\x3e\n\t\t\t\x3ctd valign\x3d"middle" style\x3d"border: thin solid"\x3e\n\t\t\t\t\x3cdiv style\x3d"float: left;" \n\t\t\t\t\tdata-dojo-attach-point\x3d"buttons_container_node"\x3e\n\t\t\t\t\t\x3ctable\x3e\n\t\t\t\t\t\t\x3ctr\x3e\n\t\t\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\t\t\x3cbutton id\x3d"${id}_addLanguageButton_node"\n\t\t\t\t\t\t\t\t\tdata-dojo-type\x3d"dijit.form.Button"\n\t\t\t\t\t\t\t\t\tdata-dojo-attach-point\x3d"addLanguageButton_node"\n\t\t\t\t\t\t\t\t\tclass\x3d"no_selection" title\x3d"${labelAddPersonTitle}"\n\t\t\t\t\t\t\t\t\tdata-dojo-attach-event\x3d"onClick:_newPersonBlank"\n\t\t\t\t\t\t\t\t\ttype\x3d"button" label\x3d"${labelAddPerson}" iconClass\x3d"addLanguage"${_disabledExp}  \x3e\x3c/button\x3e\n\t\t\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\t\t\x3cbutton id\x3d"${id}_removeLanguageButton_node"\n\t\t\t\t\t\t\t\t\tdata-dojo-type\x3d"dijit.form.Button"\n\t\t\t\t\t\t\t\t\tdata-dojo-attach-point\x3d"removeLanguageButton_node"\n\t\t\t\t\t\t\t\t\tclass\x3d"no_selection" title\x3d"${labelRemovePersonTitle}"\n\t\t\t\t\t\t\t\t\tdata-dojo-attach-event\x3d"onClick:_removePerson"\n\t\t\t\t\t\t\t\t\ttype\x3d"button" label\x3d"${labelRemovePerson}" iconClass\x3d"removeLanguage"${_disabledExp}   \x3e\x3c/button\x3e\n\t\t\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\t\x3c/table\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t\x3c/td\x3e\n\t\t\x3c/tr\x3e\n\t\x3c/table\x3e\n\x3c/div\x3e\n'}});
define("ec/fisa/widget/NotificationReceiverSelection","dojo/_base/kernel dojo/_base/declare dijit/_Widget dijit/_Templated dojo/text!./templates/NotificationReceiverSelection.html dojo/regexp dijit/form/Button dijit/form/TextBox dijit/form/ValidationTextBox dojox/lang/functional/object dojo/dom-style dojo/dom-attr dojo/dom dojo/dom-construct dijit/dijit dojo/on dijit/focus ec/fisa/widget/Utils dojo/string ./_base".split(" "),function(n,x,z,A,B,C,D,E,F,G,t,H,I,e,l,J,q){return x("ec.fisa.widget.NotificationReceiverSelection",
[z,A],{tapdFieldLenght:0,notificationDivs:null,notificationMaxLength:0,requestedAction:"",collapsed:!0,actualNotifications:0,actualValue:"",isARoutineField:!1,routineBtId:null,routineFieldId:null,routineActionMode:null,tabId:"",pageScopeId:"",styleClass:"notificationReceiverSelection",widgetsInTemplate:!0,readOnly:!1,_disabledExp:"",_connections:null,_destroyOnRemove:!0,parentEditableGrid:!1,gridId:"",gridSelectedRowIndex:null,parentType:"",visualSize:20,templateString:B,notificationMeansList:null,
priorityId:null,labelDest:"",labelChoose:"",emailRegex:null,numberRegex:null,labelAddNotification:"",labelRemoveNotification:"",labelAddPerson:"",labelRemovePerson:"",labelRemoveNotificationTitle:"",labelAddNotificationTitle:"",labelAddPersonTitle:"",labelRemovePersonTitle:"",invalidMessage:"",constructor:function(a,c){try{this.emailRegex="^[_A-Za-z0-9-\\+]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$",this.numberRegex="^[0-9]+$",this.tapdFieldLenght=a.tapdFieldLenght||0,
this.requestedAction=a.requestedAction||"",this.fieldId=a.fieldId||"",this.ref=a.ref,this.notificationDivs=[],this.notificationMeansList=[],this._connections=[]}catch(b){this.logger("No se pudo ejecutar el constructor"),this.logger(b)}},postMixInProperties:function(){!0==this.readOnly&&(this._disabledExp="disabled\x3d'disabled'")},buildRendering:function(){this.inherited(arguments);this._init()},destroy:function(){delete this.notificationDivs;this.inherited(arguments)},logger:function(a){},_createNotification:function(a,
c,b,d,p,m){var y="",f=this.priorityId,u="";a&&a&&(y=a);c&&(f=c[0],u=c[1]);a=null;if(null==d){var v=e.create("table",{id:this.id+"_destinatario"},this._tcn);a=e.create("tbody",{id:this.id+"_destinatario"},v);var h=e.create("tr",{id:this.id+"_destinatario"},a);v.style.border="thin solid";v.style.margin="5px";var h=e.create("td",{},h),h=e.create("table",{},h),r=e.create("tr",{},h),q=e.create("td",{},r),h=e.create("td",{},r);r.className="dijitTitlePaneTitle";r=e.create("div",{},q);h=e.create("div",{},
h);e.create("label",{innerHTML:this.labelDest},r);h=new l.form.ValidationTextBox({label:"Name",value:y,maxLength:this.notificationMaxLength,size:this.visualSize},h);h.set("required",!0);h.fwId=this.id}else a=d;if(c&&p||!p){var w=e.create("tr",{},a),s=e.create("td",{},w),s=e.create("table",{},s),k=e.create("tbody",{},s),g=e.create("tr",{},k),g=e.create("tr",{},g),g=e.create("div",{},g);e.create("label",{innerHTML:this.labelChoose},g);g=e.create("tr",{},k);k=e.create("td",{},g);k=e.create("div",{},
k);g=e.create("td",{},g);g=e.create("div",{},g);k=new l.form.Select({options:this.notificationMeansList,value:f,style:"width: 150px;"},k);g=new l.form.ValidationTextBox({value:u,maxLength:this.notificationMaxLength,size:this.visualSize,invalidMessage:this.invalidMessage},g);-1==f&&ec.fisa.widget.utils.disableWidget(g.id);var f=e.create("td",{},w),f=e.create("div",{id:this.id+"_button"},f),f=e.create("table",{id:this.id+"_button"},f),f=e.create("tbody",{id:this.id+"_button"},f),f=e.create("tr",{id:this.id+
"_button"},f),u=e.create("td",{},f),t=e.create("div",{},u),f=e.create("td",{},f),x=e.create("div",{},f);k.fwId=this.id;g.set("required",!0);g.set("trim",!0);g.fwId=this.id}if(c&&void 0==this.notificationDivs[b].contadorNode||null==d&&!p)c=new l.form.Button({baseClass:"dijitButton",type:"button",label:this.labelAddNotification,iconClass:"addLanguage",title:this.labelAddNotificationTitle},t),c.connect(c,"onClick",n.hitch(this,this._showMeans,c,b,a)),f=new l.form.Button({baseClass:"dijitButton",type:"button",
label:this.labelRemoveNotification,iconClass:"removeLanguage",title:this.labelRemoveNotificationTitle},x),f.connect(f,"onClick",n.hitch(this,this._removeMeans,f,b,a)),c.fwId=this.id,f.fwId=this.id;null==d?(this.notificationDivs[b]={},this.notificationDivs[b].destinatarioNode=v,this.notificationDivs[b].notification=[],this.notificationDivs[b].dest=h,this.notificationDivs[b].id=p?m:"tp_"+b,p||(this.notificationDivs[b].contadorNode=0,this.notificationDivs[b].notification[0]={},this.notificationDivs[b].notification[0].notificationRow=
w,this.notificationDivs[b].notification[0].notificationNode=s,this.notificationDivs[b].notification[0].comboBox=k,this.notificationDivs[b].notification[0].textBox=g,1>this.notificationDivs[b].dest.get("value")&&ec.fisa.widget.utils.disableWidget(k.id),this._connectEvents(k,b,0,"comboBoxNot"),this._connectEvents(g,b,0,"textBoxNot")),this._connectEvents(h,b,null,"textBoxDest")):(d=null,d=void 0==this.notificationDivs[b].contadorNode?this.notificationDivs[b].contadorNode=0:++this.notificationDivs[b].contadorNode,
this.notificationDivs[b].notification[d]={},this.notificationDivs[b].notification[d].notificationRow=w,this.notificationDivs[b].notification[d].notificationNode=s,this.notificationDivs[b].notification[d].comboBox=k,this.notificationDivs[b].notification[d].textBox=g,1>this.notificationDivs[b].dest.get("value")&&ec.fisa.widget.utils.disableWidget(k.id),this._connectEvents(k,b,d,"comboBoxNot"),this._connectEvents(g,b,d,"textBoxNot"));return a},_init:function(){this.notificationMaxLength=this.tapdFieldLenght},
_connectEvents:function(a,c,b,d){void 0==this._connections[c]&&(this._connections[c]={},this._connections[c].notification=[]);null!=b&&void 0==this._connections[c].notification[b]&&(this._connections[c].notification[b]={});"textBoxDest"===d?this._connections[c].dest=a.connect(a,"onChange",n.hitch(this,this._upDestinarioValue,c)):"comboBoxNot"===d?this._connections[c].notification[b].textBox=a.connect(a,"onChange",n.hitch(this,this._upComboBoxNot,c,b)):"textBoxNot"===d&&(this._connections[c].notification[b].comboBox=
a.connect(a,"onChange",n.hitch(this,this._upTextBoxNotValue,c,b)))},_upDestinarioValue:function(a){if(void 0!=this.notificationDivs[a]){var c=this.notificationDivs[a].dest;a=this.notificationDivs[a].notification;for(i in a)if("indexOf"!=i){var b=a[i].comboBox,d=a[i].textBox;1>c.get("value")?(ec.fisa.widget.utils.disableWidget(b.id),ec.fisa.widget.utils.disableWidget(d.id)):(ec.fisa.widget.utils.enableWidget(b.id),-1!=b.get("value")&&ec.fisa.widget.utils.enableWidget(d.id))}this.logger("Cambio detinatario.\t"+
c.get("value"))}},_upComboBoxNot:function(a,c){if(!(void 0==this.notificationDivs[a]||void 0==this.notificationDivs[a].notification[c])){var b=this.notificationDivs[a].notification[c].comboBox,d=this.notificationDivs[a].notification[c].textBox;d.get("value");-1==b.get("value")?ec.fisa.widget.utils.disableWidget(d.id):(ec.fisa.widget.utils.enableWidget(d.id),"SMS"==b.get("value")?d.set("regExp",this.numberRegex):"MAIL"==b.get("value")&&d.set("regExp",this.emailRegex));d.set("value","");this.logger("Cambio comboBox Notif.\t"+
b.get("value"))}},_upTextBoxNotValue:function(a,c){if(!(void 0==this.notificationDivs[a]||void 0==this.notificationDivs[a].notification[c])){var b=this.notificationDivs[a].notification[c].textBox;b.get("value");b.isValid()||b.set("value","")}},_newPersonBlank:function(a){try{if(a=null,a=0==this.notificationDivs.length?2:this.notificationDivs[this.actualNotifications-1].dest.get("value"),1>!a)this.notificationDivs[this.actualNotifications]||this._createNotification(null,null,this.actualNotifications,
null,!1,null),this.actualNotifications++,this.updateRowHeight();else return this.logger("No se puede anadir un destinatario."),!1}catch(c){this.logger("No se puede anadir un destinatario."),this.logger(c)}},_showMeans:function(a,c,b){try{if(1>!this.notificationDivs[c].notification[this.notificationDivs[c].contadorNode].textBox.get("value"))this.notificationDivs[c].dest&&this._createNotification(null,null,c,b,!1,null),this.updateRowHeight();else return this.logger("No se puede anadir una notificaci\u00f3n."),
!1}catch(d){this.logger("No se puede anadir una notificaci\u00f3n."),this.logger(d)}},_removePerson:function(a){a=!1;1==this.actualNotifications&&(a=!0);if(0<this.actualNotifications){var c=this.notificationDivs[this.actualNotifications-1].destinatarioNode,b=this.notificationDivs[this.actualNotifications-1].dest;this._setNotVisible(c);this.notificationDivs.splice(this.actualNotifications-1,1);var d=this._connections.splice(this.actualNotifications-1,1);n.forEach(d,function(a,b){this.disconnect(a.dest);
n.forEach(a.notification,function(a,b){this.disconnect(a.textBox);this.disconnect(a.comboBox)},this)},this);l.byId(b.id).set("value","");this.actualNotifications--;this.notificationDivs.splice(this.actualNotifications,1);e.destroy(c);b.destroy(!1);this.updateRowHeight();ec.fisa.widget.utils.programaticChange(q.curNode);!0==a&&this._newPersonBlank()}},_removeMeans:function(a,c,b){a=this.notificationDivs[c];b=a.contadorNode;if(0<b){var d=a.notification[b];this._setNotVisible(d.notificationNode);c=this._connections[c].notification.splice(b,
1);n.forEach(c,function(a,b){this.disconnect(a.textBox);this.disconnect(a.comboBox)},this);l.byId(d.textBox).set("value","");l.byId(d.comboBox).set("options",null);e.destroy(d.notificationRow);e.destroy(d.notificationNode);a.notification.splice(b,1);b=--a.contadorNode;this.updateRowHeight();ec.fisa.widget.utils.programaticChange(q.curNode)}},_collapaseNotification:function(){try{for(i=0;i<this.notificationDivs.length;i++)if(0==i){ec.fisa.widget.utils.disableWidget(this.notificationDivs[i].dest.id);
var a=this.notificationDivs[i].notification;for(j in a)if("indexOf"!=j){var c=a[j].textBox;ec.fisa.widget.utils.disableWidget(a[j].comboBox.id);ec.fisa.widget.utils.disableWidget(c.id)}}else this._setNotVisible(this.notificationDivs[i].destinatarioNode);this.updateRowHeight()}catch(b){this.logger(b)}},_expandNotification:function(){try{for(i=0;i<this.notificationDivs.length;i++){var a=this.notificationDivs[i].dest;!0==this.readOnly?ec.fisa.widget.utils.disableWidget(a.id):ec.fisa.widget.utils.enableWidget(a.id);
var c=this.notificationDivs[i].notification;for(j in c)if("indexOf"!=j){var b=c[j].comboBox,d=c[j].textBox;!0==this.readOnly?(ec.fisa.widget.utils.disableWidget(b.id),ec.fisa.widget.utils.disableWidget(d.id)):(ec.fisa.widget.utils.enableWidget(b.id),ec.fisa.widget.utils.enableWidget(d.id))}}for(i=0;i<this.actualNotifications;i++)this._setVisible(this.notificationDivs[i].destinatarioNode);this.updateRowHeight()}catch(e){this.logger(e)}},_setVisible:function(a){t.set(a,"display","block")},_setNotVisible:function(a){t.set(a,
"display","none")},_getValueAttr:function(){var a={},c;for(c in this.notificationDivs)if("indexOf"!=c){var b=this.notificationDivs[c].id,d=this.notificationDivs[c].dest;if(1>!d&&0<this.notificationDivs[c].notification.length&&1>!d.get("value"))for(j in this.notificationDivs[c].notification)if("indexOf"!=j){var e=this.notificationDivs[c].notification[j].comboBox.get("value"),m=this.notificationDivs[c].notification[j].textBox.get("value");-1!=e&&1>!m&&(void 0==a[b]&&(a[b]={},a[b].datos={},a[b].tipo=
{},a[b].datos.name=[d.get("value")]),void 0==a[b].tipo[e]&&(a[b].tipo[e]=[]),a[b].tipo[e].push(m))}}return a},_setValueAttr:function(a,c,b){c=a[0];this.notificationMeansList=a[1];this.priorityId=a[2];a[3]||(this.updateMeansList(),this.actualNotifications=0,this.notificationDivs.splice(0,this.notificationDivs.length),this._connections.splice(0,this._connections.length));this.actualValue=c;a=this.notificationDivs.length;if(null!=c)for(var d in c)if("indexOf"!=d&&0!=c[d].datos.name.length&&!this.notificationDivs[a]){b=
c[d].tipo;var e=this._createNotification(c[d].datos.name[0],null,a,null,!0,d),m;for(m in b)if("indexOf"!=m)for(var l in b[m])"indexOf"!=l&&this._createNotification(null,[m,b[m][l]],a,e,!0,null);this.actualNotifications=++a}0==this.notificationDivs.length&&(this._createNotification(null,null,0,null,!1,null),this.actualNotifications=1)},updateRowHeight:function(){null!=this.gridSelectedRowIndex&&l.byId(this.gridId).scroller.rowHeightChanged(this.gridSelectedRowIndex,!0)},updateMeansList:function(){for(var a=
this.notificationDivs.length,c=0,c=0;c<a;){var b=this.notificationDivs[c].destinatarioNode,b=this.notificationDivs[c].destinatarioNode,d=this.notificationDivs[c].dest;this._setNotVisible(b);var p=this._connections.slice(c,1);n.forEach(p,function(a,b){this.disconnect(a.dest)},this);l.byId(d.id).set("value","");d.destroy(!1);e.destroy(b);this.updateRowHeight();ec.fisa.widget.utils.programaticChange(q.curNode);c++}},isValid:function(){}})});
//@ sourceMappingURL=NotificationReceiverSelection.js.map